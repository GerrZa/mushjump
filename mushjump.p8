pico-8 cartridge // http://www.pico-8.com
version 41
__lua__
--main
function _init()
	state="start"
	
	startf=0
	
	plr={
	x=60,
	y=112,
	jf=40,
	vlx=0,
	vly=0,
	w=7,h=7,
	}
	
	plc={x=0,y=0,w=7,h=0}
	plf={}
	
	initplf()
	
	nxtplf=flr(rnd(5)+5)
	score=0
	nxth=100
	
	smk={}
end

function _update()
	if state=="game" then
		update_game()
	elseif state=="start" then
	 update_start()
	elseif state=="gameover" then
		update_gameover()
	end
	
end

function _draw()
	if state=="game" then
	 draw_game()
	elseif state=="start" then
	 draw_start()
	elseif state=="gameover" then
		draw_gameover()
	end
end

-->8
--update

function update_game()
 cls()
	if btn(âž¡ï¸) then plr.vlx+=0.5 end
	if btn(â¬…ï¸) then plr.vlx-=0.5 end
	if not(btn(âž¡ï¸) or btn(â¬…ï¸)) and plr.vlx!=0 then
		if plr.vlx>0 then
			plr.vlx-=0.5
		else
		 plr.vlx+=0.5
		end
	end
	
	if plr.vlx>2 then plr.vlx=2 end
	if plr.vlx<-2 then plr.vlx=-2 end
	
	plr.vly+=0.25
	
	move(plr)
	
	if plr.y<50 then
		plr.y=50
		score+=1
		nxtplf-=1
		nxth-=1
		for i in all(plf) do
			i.y-=plr.vly
			if i.y > 130 then
				del(plf,i)
			end
		for i in all(smk) do
		i.y+=1
		end
	end
end
	
	if nxtplf <= 0 then
		add(plf,{
		x=flr(rnd(104)),y=-8,
		w=24,h=8})
		nxtplf=flr(rnd(5)+10)
	end
	
	if plr.y >130 then
	 state="gameover"
	end
	
	if nxth<0 then
		nxth=100
		sfx(0)
	end
end

function update_start()
 if btn(ðŸ…¾ï¸) or btn(âŽ) then
 	state="game"
 	plr.vly=-5
 end
end

function update_gameover()
	if btn(ðŸ…¾ï¸) or btn(âŽ) then
		state="game"
		initplf()
		plr.vly=-5
		score=0
	end
	
end

-->8
--draw

function draw_game()
 line(0,50,128,50)
	for i=1,#plf do
		spr(2,plf[i].x,plf[i].y,3,1)
	end
	
	spr(1,plr.x,plr.y)	
	
	print(score.."m",3,44)
	
	for i in all(smk) do
 	i.x+=i.spd*i.d
	 circfill(i.x,i.y,i.sz,7)
	 i.l-=1
	 if (i.l<0) then del(smk,i) end
	end
	
end

function draw_start()
 cls()
 spr(1,plr.x,plr.y)
 for i=1,#plf do
 	spr(2,plf[i].x,plf[i].y,3,1)
 end
	startf+=1
	if startf>30 then
		startf=0
	elseif startf>10 then
		print("pressâŽ/ðŸ…¾ï¸ to start",26,105+cos(0.25+time()*0.3)*2)
	end
	spr(17,48,10+cos(time()*0.3)*2,4,4)
end

function draw_gameover()
	cls()
	
	local x1=30
	local y1=30
	local x2=98
	local y2=100
	
	for i=1,#plf do
		spr(2,plf[i].x,plf[i].y,3,1)
	end
	
	rectfill(x1,y1,x2,y2,7)
	rectfill(x1+1,y1+1,x2-1,y2-1,0)
	
	print("gameover",48,40,7)
	print("score : "..score.."m",36,60,7)
	print("pressðŸ…¾ï¸/âŽ",45,80,7)
	print(" to restart",41,86,7)
	
end
-->8
--other

function col(a,b)
	
	if a.y>=b.y and a.y<=b.y+b.h then
		if a.x>=b.x and a.x<=b.x+b.w then
		 return true
		elseif a.x+a.w>=b.x and a.x+a.w<b.x+b.w then
		 return true
		end
	elseif a.y+a.h>=b.y and a.y+a.h<=b.y+b.h then
		if a.x>=b.x and a.x<=b.x+b.w then
		 return true
		elseif a.x+a.w>=b.x and a.x+a.w<b.x+b.w then
		 return true
		end
	end
	
	return false
end

function move(o)
	local lx = o.x
	local ly = o.y
	
	o.x+=o.vlx
	o.y+=o.vly
	
	plc.x=plr.x
	plc.y=plr.y+7
	
	
	for i in all(plf) do
		if col(plc,i) and plr.vly>0 then
			plr.vly=-5
			plr.y=ly
			sfx(1)
			del(plf,i)
			crtsmk(plr)
		end
	end
	
end

function initplf()

	plf={{x=52,y=84,w=24,h=8}}
	
	for i=1,2 do
		add(plf,{
		x=flr(rnd(104)),y=plf[#plf].y-flr(30+rnd(10)),
		w=24,h=8})
	end
	
	plr={
	x=60,
	y=112,
	jf=40,
	vlx=0,
	vly=0,
	w=7,h=7
	}
end

function crtsmk(o)
	for i=1,5 do
		local dir=1
		if (i>2) then dir=-1 end
		add(smk,{
			x=o.x+flr(rnd(7)),y=o.y+3,
			spd=1+rnd(1),sz=1+flr(rnd(2)),l=4+flr(rnd(3)),
			d=dir})
	end
end
__gfx__
0000000000000000000300b00300b0303000b0300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000008888880133bb3bb3bb3bbb3b3bbb3b10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700788778873bb1bb3bb3bb1bb11bbb1bb30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000788778871bb313131bb13331b3b1bb3b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700088888888b133bb3b13bb3b3bb133bb1b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007000eeeeee0b3bb3bb3bbb3b1bb13bb313b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000f2ff2f031bbb1bb3b131bb3bb1b3b330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000effffe0131bbb131bb1333bb313bb310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000007111700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000071888170000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000077770007717878717000077777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000071117071118888817000071111700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000071881718811fff117000071881700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000071888188811fff177000071881700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000071888888811111117777771881170000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000071881818818818811111111888817000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000071221112218818811888881881881700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000071221712212212211881111221221700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000071221712212212211222221221221700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000071111711112222121111221221221700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000077777777711111111222221111111700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000077777771111117777777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000009999000000000007777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000999900000000000009900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000009990000000000009900009900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000440009900990009990099900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000999099900990044444444409999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000440044044004440099099909909999990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000444444099909999044004004409900990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000044440044444444044000044404404440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000004444044044000044009999900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000044000444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000099999900000000000000000000440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000099999999999900000000440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000099000000000440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000999999999990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000077700000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000711170000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000007188817000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000007777000771787871700007777770000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000007111707111888881700007111170000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000071881718811fff11700007188170000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000071888188811fff17700007188170000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000007188888881111111777777188117000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000007188181881881881111111188881700000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000007122111221881881188888188188170000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000007122171221221221188111122122170000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000007122171221221221122222122122170000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000007111171111222212111122122122170000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000007777777771111111122222111111170000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000007777777111111777777770000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000999900000000000777777000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000099999900000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000099990000000000000990000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000999000000000000990000990000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000044000990099000999009990000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000099909990099004444444440999900000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000044004404400444009909990990999999000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000044444409990999904400400440990099000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000004444004444444404400004440440444000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000444404404400004400999990000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000004400044400000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000009999990000000000000000000044000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000009999999999990000000044000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000009900000000044000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000099999999999000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

__sfx__
000500000c12010130131000b1001a1101e12022130271402b1002f100321003210036100381003a1003b100000000000000000000000000000000181001e100271002f100000000000000000000000000000000
000100001f05023050260502a0502f050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
